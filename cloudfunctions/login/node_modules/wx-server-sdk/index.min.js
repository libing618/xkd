!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e,t){e.exports=require("tslib")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(3),s=r(7),u=function(e){function t(t){var r=e.call(this,t.errMsg)||this;return r.errCode=-1,Object.defineProperties(r,{message:{get:function(){return"errCode: "+this.errCode+" "+(s.ERR_CODE[this.errCode]||"")+" | errMsg: "+this.errMsg},set:function(e){this.errMsg=e}}}),r.errCode=t.errCode||-1,r.errMsg=t.errMsg,r}return n.__extends(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: "+this.errCode+" | errMsg: "+this.errMsg},set:function(e){this.errMsg=e},enumerable:!0,configurable:!0}),t}(Error);function a(e){return e&&e instanceof Error&&o.isString(e.errMsg)}function c(e,t){if(void 0===t&&(t=""),e){if(a(e))return t&&(e.errMsg+="; "+t),e;var r=e?e.errCode:void 0,n=(e&&e.errMsg||e.toString()||"unknown error")+"; "+t;return new u({errCode:r,errMsg:n})}return new u({errMsg:t})}t.CloudSDKError=u,t.createError=function(e){var t=void 0===e?{}:e,r=t.errCode,n=void 0===r?1:r,o=t.errMsg,i=void 0===o?"":o,s=t.errClass;return new(void 0===s?u:s)({errCode:n,errMsg:i})},t.isSDKError=a,t.returnAsCloudSDKError=c,t.returnAsFinalCloudSDKError=function(e,t){if(e&&a(e))return e;var r=c(e,"at "+t+" api; ");return r.errMsg=i.apiFailMsg(t,r.errMsg),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(1),s=r(9),u=function(){function e(){this.inited=!1,this.services={},this.exportAPI={init:this.init.bind(this)},this.meta={session_id:(+new Date).toString()},this.defaultConfig={},this.provider=o.default()}return e.prototype.getMetaData=function(){return this.meta},e.prototype.getDefaultConfig=function(){return this.defaultConfig},e.prototype.getOverriddenConfig=function(e){var t=n.__assign({},this.defaultConfig);return Object.assign(t,e),t},e.prototype.getEnv=function(e,t){if(e.env)switch(s.getType(e.env)){case"string":return e.env;case"object":return e.env[t];default:return}},e.prototype.init=function(e){void 0===e&&(e={}),this.inited||(this.inited=!0,this.provider.init(e),this.defaultConfig=e)},e.prototype.registerService=function(e){this.services[e.name]=e;var t=e.getAPIs();for(var r in t)this.registerFunction(r,t[r])},e.prototype.registerFunction=function(e,t){var r=this;this.exportAPI[e]=function(){if(!r.inited)throw new i.CloudSDKError({errMsg:"Cloud API isn't enabled, please call init first\n请先调用 init 完成初始化后再调用其他云 API。init 方法可传入一个对象用于设置默认配置，详见文档。"});return t.apply(this,arguments)}},e}();t.Cloud=u;var a=new u;t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apiSuccessMsg=function(e){return e+":ok"},t.apiCancelMsg=function(e,t){return e+":cancel "+t},t.apiFailMsg=function(e,t){return e+":fail "+t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(1),i=r(7);function s(e,t,r){void 0===r&&(r="parameter");var o=function e(t,r,o){var i=n.getType(t),s=n.getType(r);if("string"===s)return i!==r?o+" should be "+r+" instead of "+i+";":"";if(i!==s)return o+" should be "+s+" instead of "+i+"; ";var u="";switch(i){case"object":for(var a in r)u+=e(t[a],r[a],o+"."+a);break;case"array":for(var c=0;c<r.length;c++)u+=e(t[c],r[c],o+"["+c+"]")}return u}(e,t,r);return{passed:!o,reason:o}}function u(e,t,r){void 0===r&&(r="parameter");var o=function(e,t,r){var o=n.getType(e);if("object"!==n.getType(t))return"";if("object"!==o)return r+" should be object instead of "+o;for(var i in e){var u=e[i];if(void 0!==u&&null!==i){var a=s(u,t[i],r+"."+i);return a.passed?"":a.reason}}return""}(e,t,r);return{passed:!o,reason:o}}t.sameType=function(e,t,r){var o=function e(t,r,o){var i=n.getType(t),s=n.getType(r);if(i!==s)return o+" should be "+s+" instead of "+i+"; ";var u="";switch(i){case"object":for(var a in r)u+=e(t[a],r[a],o+"."+a);break;case"array":for(var c=0;c<r.length;c++)u+=e(t[c],r[c],o+"["+c+"]")}return u}(e,t,r);return{passed:!o,reason:o}},t.validType=s,t.validObjectOptionalType=u,t.assertType=function(e,t,r,n){void 0===r&&(r="parameter"),void 0===n&&(n=o.CloudSDKError);var i=s(e,t,r);if(!i.passed)throw new n({errMsg:i.reason})},t.assertObjectOptionalType=function(e,t,r,n){void 0===r&&(r="parameter"),void 0===n&&(n=o.CloudSDKError);var i=u(e,t,r);if(!i.passed)throw new n({errMsg:i.reason})},t.assertRequiredParam=function(e,t,r,n){if(void 0===n&&(n=o.CloudSDKError),!e)throw new n({errMsg:"parameter "+t+" of function "+r+" must be provided"})},t.assertObjectNotEmpty=function(e){var t=e.target,r=e.name,n=e.ErrorClass,s=void 0===n?o.CloudSDKError:n;if(0===Object.keys(t).length)throw new s({errCode:i.ERR_CODE.SDK_API_PARAMETER_ERROR,errMsg:r+" must not be empty"})}},function(e,t){e.exports=require("tcb-admin-node")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCB_ERR_CODE={SUCCESS:0,SYS_ERR:-501001,SERVER_TIMEOUT:-501002,EXCEED_REQUEST_LIMIT:-501003,EXCEED_CONCURRENT_REQUEST_LIMIT:-501004,INVALIID_ENV:-501005,INVALID_COMMON_PARAM:-501006,INVALID_PARAM:-501007,INVALID_REQUEST_SOURCE:-501008,RESOURCE_NOT_INITIAL:-501009,DATABASE_REQUEST_FAILED:-502001,DATABASE_INVALID_OPERRATOR:-502002,DATABASE_PERMISSION_DENIED:-502003,DATABASE_COLLECTION_EXCEED_LIMIT:-502004,DATABASE_COLLECTION_NOT_EXIST:-502005,STORAGE_REQUEST_FAIL:-503001,STORAGE_EXCEED_AUTHORITY:-503002,STORAGE_FILE_NONEXIST:-503003,STORAGE_SIGN_PARAM_INVALID:-503004,FUNCTIONS_REQUEST_FAIL:-504001,FUNCTIONS_EXECUTE_FAIL:-504002}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_CODE={"-1":"unknown error",UNKNOWN_ERROR:-1,"-404001":"empty call result",SDK_FUNCTIONS_EMPTY_CALL_RESULT:-404001,"-404002":"empty event id",SDK_FUNCTIONS_EMPTY_EVENT_ID:-404002,"-404003":"empty poll url",SDK_FUNCTIONS_EMPTY_POLL_URL:-404003,"-404004":"empty poll result json",SDK_FUNCTIONS_EMPTY_POLL_RESULT_JSON:-404004,"-404005":"exceed max poll retry",SDK_FUNCTIONS_EXCEED_MAX_POLL_RETRY:-404005,"-404006":"empty poll result base resp",SDK_FUNCTIONS_EMPTY_POLL_RESULT_BASE_RESP:-404006,"-404007":"error while polling for the result, poll result base resp ret %s",SDK_FUNCTIONS_POLL_RESULT_BASE_RESP_RET_ABNORMAL:-404007,"-404008":"error while polling for the result, polling server return a status code of %s",SDK_FUNCTIONS_POLL_RESULT_STATUS_CODE_ERROR:-404008,"-404009":"error while polling for the result: %s",SDK_FUNCTIONS_POLL_ERROR:-404009,"-601001":"system error",WX_SYSTEM_ERROR:-601001,"-601002":"system args error",WX_SYSTEM_ARGS_ERROR:-601002,"-601003":"system network error",WX_SYSTEM_NETWORK_ERROR:-601003,"-501001":"resource system error",TCB_RESOURCE_SYSTEM_ERROR:-501001,"-501002":"resource server timeout",TCB_RESOURCE_SERVER_TIMEOUT:-501002,"-501003":"exceed request limit",TCB_EXCEED_REQUEST_LIMIT:-501003,"-501004":"exceed concurrent request limit",TCB_EXCEED_CONCURRENT_REQUEST_LIMIT:-501004,"-501005":"invalid env",TCB_INVALID_ENV:-501005,"-501006":"invalid common parameters",TCB_INVALID_COMMON_PARAM:-501006,"-501007":"invalid parameters",TCB_INVALID_PARAM:-501007,"-501008":"invalid request source",TCB_INVALID_REQUEST_SOURCE:-501008,"-501009":"resource not initialized",TCB_RESOURCE_NOT_INITIALIZED:-501009,"-502001":"database request fail",TCB_DB_REQUEST_FAIL:-502001,"-502002":"database invalid command",TCB_DB_INVALID_COMMAND:-502002,"-502003":"database permission denied",TCB_DB_PERMISSION_DENIED:-502003,"-502004":"database exceed collection limit",TCB_DB_EXCEED_COLLECTION_LIMIT:-502004,"-502005":"database collection not exists",TCB_DB_COLLECTION_NOT_EXISTS:-502005,"-503001":"storage request fail",TCB_STORAGE_REQUEST_FAIL:-503001,"-503002":"storage permission denied",TCB_STORAGE_PERMISSION_DENIED:-503002,"-503003":"storage file not exists",TCB_STORAGE_FILE_NOT_EXISTS:-503003,"-503004":"storage invalid sign parameter",TCB_STORAGE_INVALID_SIGN_PARAM:-503004,"-504001":"functions request fail",TCB_FUNCTIONS_REQUEST_FAIL:-504001,"-504002":"functions execute fail",TCB_FUNCTIONS_EXEC_FAIL:-504002}},function(e,t){e.exports=require("tcb-admin-node/src/utils/httpRequest")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(21);t.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},t.isObject=function(e){return"object"===t.getType(e)},t.isString=function(e){return"string"===t.getType(e)},t.isNumber=function(e){return"number"===t.getType(e)},t.isPromise=function(e){return"promise"===t.getType(e)},t.isFunction=function(e){return"function"==typeof e},t.isArray=function(e){return Array.isArray(e)},t.isDate=function(e){return"date"===t.getType(e)},t.isInternalObject=function(e){return e&&e._internalType instanceof n.InternalSymbol},t.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(6);t.checkError=function(e){if(e&&e.code)throw n.returnAsCloudSDKError({errCode:o.TCB_ERR_CODE[e.code]||o.TCB_ERR_CODE.SYS_ERR,errMsg:e.message})}},function(e,t,r){"use strict";e.exports=r(12)},function(e,t,r){"use strict";var n=r(2);r(22),r(28),r(34),r(37),e.exports=n.default.exportAPI},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(14);!function(e){e[e.TCB=0]="TCB"}(n=t.PROVIDER||(t.PROVIDER={})),t.default=function(e){return void 0===e&&(e=n.TCB),o.default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(8),s=r(15),u=r(16),a=r(17),c=r(18),d=r(19),l=r(20),f={init:o.init.bind(o),get config(){return o.config},sendRequest:function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,i(n.__assign({config:o.config,params:e.data},e))]})})},api:{addDocument:s.addDocument,queryDocument:s.queryDocument,updateDocument:s.updateDocument,removeDocument:s.removeDocument,countDocument:s.countDocument,callFunction:u.callFunction,downloadFile:a.downloadFile,uploadFile:c.uploadFile,deleteFile:d.deleteFile,getTempFileURL:l.getTempFileURL}};t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(8),s=r(6),u=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})},a=function(e,t){var r=n.__assign({},e);return t.env&&(r.env=t.env),r};t.addDocument=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,u()];case 1:return n.sent(),[4,i({params:{action:"database.addDocument",_id:e._id,collectionName:e.collectionName,data:e.data},config:a(o.config,t),method:"post",headers:{"content-type":"application/json"}})];case 2:if((r=n.sent()).code&&0!==s.TCB_ERR_CODE[r.code])throw{errCode:s.TCB_ERR_CODE[r.code]||s.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{_id:r.data._id,requestId:r.requestId}]}})})},t.queryDocument=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(c){switch(c.label){case 0:return[4,u()];case 1:return c.sent(),[4,i({params:n.__assign({},e,{action:"database.queryDocument",collectionName:e.collectionName}),config:a(o.config,t),method:"post",headers:{"content-type":"application/json"}})];case 2:if((r=c.sent()).code)throw{errCode:s.TCB_ERR_CODE[r.code]||s.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{list:r.data.list||[],limit:r.Limit,offset:r.Offset,total:r.TotalCount,requestId:r.requestId}]}})})},t.updateDocument=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(c){switch(c.label){case 0:return[4,u()];case 1:return c.sent(),[4,i({params:n.__assign({},e,{action:"database.updateDocument",collectionName:e.collectionName}),config:a(o.config,t),method:"post",headers:{"content-type":"application/json"}})];case 2:if((r=c.sent()).code)throw{errCode:s.TCB_ERR_CODE[r.code]||s.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{updated:r.data.updated,upsertedId:r.data.upserted_id,requestId:r.requestId}]}})})},t.removeDocument=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(c){switch(c.label){case 0:return[4,u()];case 1:return c.sent(),[4,i({params:n.__assign({},e,{action:"database.removeDocument",collectionName:e.collectionName}),config:a(o.config,t),method:"post",headers:{"content-type":"application/json"}})];case 2:if((r=c.sent()).code)throw{errCode:s.TCB_ERR_CODE[r.code]||s.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{removed:r.deleted,requestId:r.requestId}]}})})},t.countDocument=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(c){switch(c.label){case 0:return[4,u()];case 1:return c.sent(),[4,i({params:n.__assign({},e,{action:"database.countDocument",collectionName:e.collectionName}),config:a(o.config,t),method:"post",headers:{"content-type":"application/json"}})];case 2:if((r=c.sent()).code)throw{errCode:s.TCB_ERR_CODE[r.code]||s.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{total:r.data.total,requestId:r.requestId}]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(8),s=r(6),u=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})},a=function(e,t){var r=n.__assign({},e);return t.env&&(r.env=t.env),r};t.callFunction=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,u()];case 1:return n.sent(),[4,i({params:{action:"functions.invokeFunction",function_name:e.name,request_data:e.dataStr},timeout:3e5,config:a(o.config,t),method:"post",headers:{"content-type":"application/json"}})];case 2:if((r=n.sent()).code&&0!==s.TCB_ERR_CODE[r.code])throw{errCode:s.TCB_ERR_CODE[r.code]||s.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{result:r.data.response_data,requestId:r.requestId}]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(6),s=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})};t.downloadFile=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,s()];case 1:return n.sent(),t=200,[4,o.downloadFile({fileID:e.fileID})];case 2:if((r=n.sent()).code&&0!==i.TCB_ERR_CODE[r.code])throw{errCode:i.TCB_ERR_CODE[r.code]||i.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{statusCode:t,fileContent:r.fileContent}]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(6),s=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})};t.uploadFile=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,s()];case 1:return n.sent(),t=-1,[4,o.uploadFile({cloudPath:e.cloudPath,fileContent:e.fileContent},{onResponseReceived:function(e){t=e?e.statusCode:t}})];case 2:if((r=n.sent()).code&&0!==i.TCB_ERR_CODE[r.code])throw{errCode:i.TCB_ERR_CODE[r.code]||i.TCB_ERR_CODE.SYS_ERR,errMsg:r.message};return[2,{fileID:r.fileID,requestId:r.requestId,statusCode:t}]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(6),s=r(7),u=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})};t.deleteFile=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return[4,u()];case 1:return r.sent(),[4,o.deleteFile({fileList:e.fileList})];case 2:if((t=r.sent()).code&&0!==i.TCB_ERR_CODE[t.code])throw{errCode:i.TCB_ERR_CODE[t.code]||i.TCB_ERR_CODE.SYS_ERR,errMsg:t.message};return[2,{fileList:(t.fileList||[]).filter(function(e){return Boolean(e)}).map(function(e){if(e.code&&0!==i.TCB_ERR_CODE[e.code]){var r=i.TCB_ERR_CODE[t.code]||i.TCB_ERR_CODE.SYS_ERR;return{fileID:e.fileID,status:i.TCB_ERR_CODE[t.code]||i.TCB_ERR_CODE.SYS_ERR,errMsg:s.ERR_CODE[r]}}return{fileID:e.fileID,status:0,errMsg:"ok"}}),requestId:t.requestId}]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(6),s=r(7),u=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})};t.getTempFileURL=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return[4,u()];case 1:return r.sent(),[4,o.getTempFileURL({fileList:e.fileList})];case 2:if((t=r.sent()).code&&0!==i.TCB_ERR_CODE[t.code])throw{errCode:i.TCB_ERR_CODE[t.code]||i.TCB_ERR_CODE.SYS_ERR,errMsg:t.message};return[2,{fileList:(t.fileList||[]).filter(function(e){return Boolean(e)}).map(function(e,r){if(e.code&&0!==i.TCB_ERR_CODE[e.code]){var n=i.TCB_ERR_CODE[t.code]||i.TCB_ERR_CODE.SYS_ERR;return{fileID:e.fileID,status:i.TCB_ERR_CODE[t.code]||i.TCB_ERR_CODE.SYS_ERR,errMsg:s.ERR_CODE[n],maxAge:e.maxAge,tempFileURL:""}}return{fileID:e.fileID,status:0,errMsg:"ok",maxAge:e.maxAge,tempFileURL:e.tempFileURL}}),requestId:t.requestId}]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=[],i={},s=function(e){function t(t,r){if(r!==i)throw new TypeError("InternalSymbol cannot be constructed with new operator");return e.call(this,t)||this}return n.__extends(t,e),t.for=function(e){for(var r=0,n=o.length;r<n;r++)if(o[r].target===e)return o[r].instance;var s=new t(e,i);return o.push({target:e,instance:s}),s},t}(function(){return function(e){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:e}})}}());t.InternalSymbol=s,t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(23),i="database";function s(e){e.registerService(function(){return{name:i,getAPIs:o.getAPIs}}())}t.registerService=s,s(n.default)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24);t.getAPIs=function(){return{database:n.default}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(25),i=r(4);t.default=function(e){return new s(e)};var s=function(){function e(e){this.config=e||{},this._db=n.database(),this.command=this._db.command,this.Geo=this._db.Geo,this.serverDate=this._db.serverDate,e&&e.env&&i.assertType(e.env,"string")}return e.prototype.collection=function(e){return new o.CollectionReference(this._db.collection(e),e,this)},e}();t.Database=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(26),i=r(27),s=r(3),u=r(1),a=r(4),c=r(10),d=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o._collection=t,o.collectionName=r,o.database=n,o}return n.__extends(t,e),t.prototype.doc=function(e){return new i.DocumentReference(this._collection.doc(e),this,e,this.database)},t.prototype.add=function(e){var t=this;return new Promise(function(r,o){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),a.assertType(e,{data:"object"}),a.assertObjectNotEmpty({name:"options.data",target:e.data}),[4,this._collection.add(e.data)];case 1:return t=n.sent(),c.checkError(t),r({_id:t.id,errMsg:s.apiSuccessMsg("collection.add")}),[3,3];case 2:return i=n.sent(),o(u.returnAsFinalCloudSDKError(i,"collection.add")),[3,3];case 3:return[2]}})})})},t}(o.Query);t.CollectionReference=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(3),i=r(4),s=r(1),u=r(10);!function(e){e.ASC="asc",e.DESC="desc"}(t.ORDER_DIRECTION||(t.ORDER_DIRECTION={}));var a=function(){function e(e,t,r){this._query=e,this.collectionName=t,this.database=r}return e.prototype.field=function(t){return new e(this._query.field(t),this.collectionName,this.database)},e.prototype.where=function(t){return new e(this._query.where(t),this.collectionName,this.database)},e.prototype.orderBy=function(t,r){return new e(this._query.orderBy(t,r),this.collectionName,this.database)},e.prototype.limit=function(t){return new e(this._query.limit(t),this.collectionName,this.database)},e.prototype.skip=function(t){return new e(this._query.skip(t),this.collectionName,this.database)},e.prototype.get=function(e){var t=this;return new Promise(function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._query.get()];case 1:return t=n.sent(),u.checkError(t),e({data:t.data,errMsg:o.apiSuccessMsg("collection.get")}),[3,3];case 2:return i=n.sent(),r(s.returnAsFinalCloudSDKError(i,"collection.get")),[3,3];case 3:return[2]}})})})},e.prototype.update=function(e){var t=this;return new Promise(function(r,a){return n.__awaiter(t,void 0,void 0,function(){var t,c;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),i.assertType(e,{data:"object"}),i.assertObjectNotEmpty({name:"options.data",target:e.data}),[4,this._query.update(e.data)];case 1:return t=n.sent(),u.checkError(t),r({stats:{updated:t.updated||0},errMsg:o.apiSuccessMsg("collection.update")}),[3,3];case 2:return c=n.sent(),a(s.returnAsFinalCloudSDKError(c,"collection.update")),[3,3];case 3:return[2]}})})})},e.prototype.remove=function(e){var t=this;return new Promise(function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._query.remove()];case 1:return t=n.sent(),u.checkError(t),e({stats:{removed:t.removed},errMsg:o.apiSuccessMsg("collection.remove")}),[3,3];case 2:return i=n.sent(),r(s.returnAsFinalCloudSDKError(i,"collection.remove")),[3,3];case 3:return[2]}})})})},e.prototype.count=function(e){var t=this;return new Promise(function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._query.count()];case 1:return t=n.sent(),u.checkError(t),e({total:t.total,errMsg:o.apiSuccessMsg("collection.count")}),[3,3];case 2:return i=n.sent(),r(s.returnAsFinalCloudSDKError(i,"collection.count")),[3,3];case 3:return[2]}})})})},e}();t.Query=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(3),i=r(1),s=r(4),u=r(10),a=function(){function e(e,t,r,n){this._document=e,this.collection=t,this.database=n,this._id=r}return e.prototype.field=function(t){return s.assertRequiredParam(t,"object","field"),s.assertType(t,"object","field"),new e(this._document.field(t),this.collection,this._id,this.database)},e.prototype.get=function(e){var t=this;return new Promise(function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,s,a;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this._id,[4,this._document.get()];case 1:if(s=n.sent(),u.checkError(s),!s.data||!s.data.length)throw"document with _id "+t+" does not exist";return e({data:s.data[0],errMsg:o.apiSuccessMsg("document.get")}),[3,3];case 2:return a=n.sent(),r(i.returnAsFinalCloudSDKError(a,"document.get")),[3,3];case 3:return[2]}})})})},e.prototype.set=function(e){var t=this;return new Promise(function(r,a){return n.__awaiter(t,void 0,void 0,function(){var t,c,d;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),s.assertType(e,{data:"object"}),s.assertObjectNotEmpty({name:"options.data",target:e.data}),t=this._id,[4,this._document.set(e.data)];case 1:return c=n.sent(),u.checkError(c),r({_id:t,errMsg:o.apiSuccessMsg("document.set"),stats:{updated:c.updated,created:c.upsertedId?1:0}}),[3,3];case 2:return d=n.sent(),a(i.returnAsFinalCloudSDKError(d,"document.set")),[3,3];case 3:return[2]}})})})},e.prototype.update=function(e){var t=this;return new Promise(function(r,a){return n.__awaiter(t,void 0,void 0,function(){var t,c;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),s.assertType(e,{data:"object"}),s.assertObjectNotEmpty({name:"options.data",target:e.data}),[4,this._document.update(e.data)];case 1:return t=n.sent(),u.checkError(t),r({stats:{updated:t.updated},errMsg:o.apiSuccessMsg("document.update")}),[3,3];case 2:return c=n.sent(),a(i.returnAsFinalCloudSDKError(c,"document.update")),[3,3];case 3:return[2]}})})})},e.prototype.remove=function(e){var t=this;return new Promise(function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t,s;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._document.remove()];case 1:return t=n.sent(),u.checkError(t),e({stats:{removed:t.deleted||0},errMsg:o.apiSuccessMsg("document.remove")}),[3,3];case 2:return s=n.sent(),r(i.returnAsFinalCloudSDKError(s,"document.remove")),[3,3];case 3:return[2]}})})})},e}();t.DocumentReference=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(29),i="storage";function s(e){e.registerService(function(){return{name:i,getAPIs:o.getAPIs}}())}t.registerService=s,s(n.default)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(30),o=r(31),i=r(32),s=r(33);t.getAPIs=function(){return{uploadFile:n.default,downloadFile:o.default,getTempFileURL:i.default,deleteFile:s.default}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(1),s=r(2),u=r(3);t.default=function(e){var t=this,r="uploadFile";return new Promise(function(a,c){return n.__awaiter(t,void 0,void 0,function(){var t,d,l;return n.__generator(this,function(n){switch(n.label){case 0:if(!e)return[2,c(i.returnAsFinalCloudSDKError({errMsg:"Params for uploadFile must be an object instead of "+typeof e},r))];try{if(o.assertType(e,{cloudPath:"string"}),!e.fileContent)return[2,c(i.returnAsFinalCloudSDKError(new Error("Type of fileContent must be fs.ReadStream instead of "+typeof e.fileContent),r))]}catch(e){return[2,c(i.returnAsFinalCloudSDKError(e,r))]}t=e.header||{},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.default.provider.api.uploadFile({fileContent:e.fileContent,cloudPath:e.cloudPath,header:t},{})];case 2:return d=n.sent(),[2,a({fileID:d.fileID,statusCode:d.statusCode,errMsg:u.apiSuccessMsg(r)})];case 3:return l=n.sent(),[2,c(i.returnAsFinalCloudSDKError(l,r))];case 4:return[2]}})})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(1),s=r(2),u=r(3);t.default=function(e){var t=this,r="downloadFile";return new Promise(function(a,c){return n.__awaiter(t,void 0,void 0,function(){var t,d;return n.__generator(this,function(n){switch(n.label){case 0:if(!e)return[2,c(i.returnAsFinalCloudSDKError({errMsg:"Params for downloadFile must be an object instead of "+typeof e},r))];try{o.assertType(e,{fileID:"string"})}catch(e){return[2,c(i.returnAsFinalCloudSDKError(e,r))]}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.default.provider.api.downloadFile({fileID:e.fileID},{})];case 2:return t=n.sent(),[2,a({fileContent:t.fileContent,statusCode:t.statusCode,errMsg:u.apiSuccessMsg(r)})];case 3:return d=n.sent(),[2,c(i.returnAsFinalCloudSDKError(d,r))];case 4:return[2]}})})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(1),s=r(2),u=r(3);t.default=function(e){var t=this,r="getTempFileURL";return new Promise(function(a,c){return n.__awaiter(t,void 0,void 0,function(){var t,d;return n.__generator(this,function(n){switch(n.label){case 0:if(!e)return[2,c(i.returnAsFinalCloudSDKError({errMsg:"Params for getTempFileURL must be an object instead of "+typeof e},r))];try{o.assertType(e,{fileList:"array"})}catch(e){return[2,c(i.returnAsFinalCloudSDKError(e,r))]}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.default.provider.api.getTempFileURL({fileList:e.fileList},{})];case 2:return t=n.sent(),[2,a({fileList:t.fileList,errMsg:u.apiSuccessMsg(r)})];case 3:return d=n.sent(),[2,c(i.returnAsFinalCloudSDKError(d,r))];case 4:return[2]}})})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(1),s=r(2),u=r(3);t.default=function(e){var t=this;return new Promise(function(r,a){return n.__awaiter(t,void 0,void 0,function(){var t,c;return n.__generator(this,function(n){switch(n.label){case 0:if(!e)return[2,a(i.returnAsFinalCloudSDKError({errMsg:"Params for deleteFile must be an object instead of "+typeof e},"deleteFile"))];try{o.assertType(e,{fileList:"array"}),e.fileList.forEach(function(e,t){if("string"!=typeof e)throw new Error("Type of fileList["+t+"] must be string instead of "+typeof e)})}catch(e){return[2,a(i.returnAsFinalCloudSDKError(e,"deleteFile"))]}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.default.provider.api.deleteFile({fileList:e.fileList},{})];case 2:return t=n.sent(),[2,r({fileList:t.fileList,errMsg:u.apiSuccessMsg("deleteFile")})];case 3:return c=n.sent(),[2,a(i.returnAsFinalCloudSDKError(c,"deleteFile"))];case 4:return[2]}})})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(35),i="functions";function s(e){e.registerService(function(){return{name:i,getAPIs:o.getAPIs}}())}t.registerService=s,s(n.default)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(36);t.getAPIs=function(){return{callFunction:n.default}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(1),s=r(2),u=r(3);t.default=function(e){var t=this,r="callFunction";return new Promise(function(a,c){return n.__awaiter(t,void 0,void 0,function(){var t,d,l,f;return n.__generator(this,function(n){switch(n.label){case 0:if(!e)return[2,c(i.returnAsFinalCloudSDKError({errMsg:"Params for callFunction must be an object instead of "+typeof e},r))];try{o.assertType(e,{name:"string"}),e.data&&o.assertType(e,{data:"object"})}catch(e){return[2,c(i.returnAsFinalCloudSDKError(e,r))]}try{t=e.data?JSON.stringify(e.data):""}catch(e){return[2,c(i.returnAsFinalCloudSDKError(e,r))]}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.default.provider.api.callFunction({name:e.name,dataStr:t},e.config||{})];case 2:d=n.sent(),l=d.result;try{"string"==typeof l&&(l=JSON.parse(d.result))}catch(e){}return[2,a({result:l,errMsg:u.apiSuccessMsg(r)})];case 3:return f=n.sent(),[2,c(i.returnAsFinalCloudSDKError(f,r))];case 4:return[2]}})})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(38),i="utils";function s(e){e.registerService(function(){return{name:i,getAPIs:o.getAPIs}}())}t.registerService=s,s(n.default)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAPIs=function(){return{}}}]));
//# sourceMappingURL=index.min.js.map